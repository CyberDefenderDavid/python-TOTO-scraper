<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Singapore Pools TOTO Results</title>
  <style>
    body { font-family: sans-serif; margin: 2rem; }
    h1 { color: #2e7d32; }
    label { margin-right: 0.5rem; }
    select { margin-right: 1rem; padding: 0.3rem; }
    table { width: 100%; border-collapse: collapse; margin-top: 1rem; }
    th, td { padding: 0.6rem; border: 1px solid #ccc; text-align: center; }
    th { background-color: #f0f0f0; }
    #totoGenOutput { font-size: 1.3rem; margin-top: 1rem; color: #444; }
    .section { margin-top: 2.5rem; }
  </style>
</head>
<body>

  <h1>TOTO Results</h1>

  <div>
    <label for="drawFilter">Filter by Draw Number:</label>
    <select id="drawFilter">
      <option value="all">All</option>
    </select>

    <label for="dateFilter">Filter by Date:</label>
    <select id="dateFilter">
      <option value="all">All</option>
    </select>
  </div>

  <table id="totoTable">
    <thead>
      <tr>
        <th>Date</th>
        <th>Draw Number</th>
        <th>Winning Numbers</th>
        <th>Additional Number</th>
      </tr>
    </thead>
    <tbody></tbody>
  </table>

  <div class="section">
    <h2>ðŸŽ² TOTO Gen (Quick Pick)</h2>
    <button onclick="generateToto()">Generate Numbers</button>
    <p id="totoGenOutput"></p>
  </div>

  <script>
    let allData = [];

    fetch('toto_result.json')
      .then(response => response.json())
      .then(data => {
        allData = data;
        populateDropdowns(data);
        renderTable(data);
      })
      .catch(error => {
        console.error("Error loading TOTO results:", error);
      });

    function populateDropdowns(data) {
      const drawSet = new Set();
      const dateSet = new Set();

      data.forEach(r => {
        drawSet.add(r.draw_number);
        dateSet.add(r.date);
      });

      const drawFilter = document.getElementById('drawFilter');
      [...drawSet].sort().reverse().forEach(draw => {
        const option = document.createElement('option');
        option.value = draw;
        option.textContent = draw;
        drawFilter.appendChild(option);
      });

      const dateFilter = document.getElementById('dateFilter');
      [...dateSet].sort((a, b) => new Date(b) - new Date(a)).forEach(date => {
        const option = document.createElement('option');
        option.value = date;
        option.textContent = date;
        dateFilter.appendChild(option);
      });

      drawFilter.addEventListener('change', applyFilters);
      dateFilter.addEventListener('change', applyFilters);
    }

    function applyFilters() {
      const draw = document.getElementById('drawFilter').value;
      const date = document.getElementById('dateFilter').value;

      let filtered = allData;

      if (draw !== "all") {
        filtered = filtered.filter(r => r.draw_number === draw);
      }

      if (date !== "all") {
        filtered = filtered.filter(r => r.date === date);
      }

      renderTable(filtered);
    }

    function renderTable(data) {
      const tbody = document.querySelector('#totoTable tbody');
      tbody.innerHTML = "";
      if (data.length === 0) {
        tbody.innerHTML = "<tr><td colspan='4'>No results found.</td></tr>";
        return;
      }
      data.forEach(result => {
        const row = document.createElement('tr');
        row.innerHTML = `
          <td>${result.date}</td>
          <td>${result.draw_number}</td>
          <td>${result.winning_numbers.join(', ')}</td>
          <td>${result.additional_number}</td>
        `;
        tbody.appendChild(row);
      });
    }

    function generateToto() {
      const numbers = new Set();
      while (numbers.size < 6) {
        numbers.add(Math.floor(Math.random() * 49) + 1);
      }
      const sorted = [...numbers].sort((a, b) => a - b);
      document.getElementById('totoGenOutput').textContent =
        "Your TOTO Numbers: " + sorted.join(', ');
    }
  </script>

</body>
</html>
